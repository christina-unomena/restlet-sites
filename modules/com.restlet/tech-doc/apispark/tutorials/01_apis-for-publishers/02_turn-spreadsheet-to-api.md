# Turn your Google Spreadsheet into a custom web API

## Introduction

This tutorial will show you how to create a custom web API that gives access to existing data stored in a Google Spreasheet. [Google Spreadsheet](http://docs.google.com/) is a popular collaborative data editing tool within the Google Docs suite.

## Requirements

To follow this tutorial, you will need:

*   a web browser,
*   20 minutes of your time,
*   a Google Account application-specific password.

## 1. Prepare the Google Spreadsheet

Sign in to your **Google Drive** account.

In this tutorial example, we have a spreadsheet with a worksheet named **Contacts** with the following columns, containing a list of contacts:

*   **contact_id** : autogenerated primary key
*   **lastName** (string) : last name
*   **firstName** (string) : first name
*   **age** (integer) : age

Add a **Contact** so that you can retrieve it later when performing an HTTP call to your API.
We've chosen to name ours John Smith, 34 years old.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-01-sheet.png)

## 2. Configure the Entity Store Wrapper

Sign in to your **APISpark** account.

Click on **+ Data Store**.

Make sure the **Entity Store** button is selected.

Fill in a name. For this tutorial we will use **Contact Entity Store**.

Input a description if you wish.

For **Source**, select **Google Spreadsheet**.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-02-createStore.png)

Click **Create**. You will be taken to the **Entity Store** overview tab.

Click on the **Settings** tab.

In the **Security** drop down, click on **Google Account**.

>**Note:** Please do not overlook the next step, it is important to ensure your wrapper will work properly throughout the creation and deployment of your API.

Open a new tab on your browser.

Head to your **Google Account Settings** - [**<u>Security</u>**](https://www.google.com/settings/security?hl=en) page and check that **2-step authentication is activated**. If **2-step authentication** is not activated, you need to activate it before proceeding.

Once activated, go back to the [**<u>Security</u>**](https://www.google.com/settings/security?hl=en) page, click on **Settings** near **App Passwords** and generate a new application-specific password for APISpark. You will use it as your **Client Secret**.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-03-authorize.png)

Go back to APISpark and input your **Client ID** (your email) and the **Client Secret** you just created (email address and password).

>**Note:** we are working to leverage Google OAuth authentication to remove the need to access your Google Account.

Click on the **Test** button, to ensure the connection between APISpark and your Google Account is well configured.
      ![](/static/images/site/tutorials/tutorial-googlespreadsheet-04-googleAccount.png)

When connected, click on **Import a sheet** and APISpark will automatically detect all spreadsheets on your account.

Select the sheet to import and click **Add**.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-05-apiSettings.png)

Under **Imports** dropdown, you can click on the sheet which opens the **Overview** tab. It displays hints about the sheet and gives you the ability to select the worksheets you want by clicking the **Update work sheets** button.
      ![](/static/images/site/tutorials/tutorial-googlespreadsheet-06-imports.png)

Click the **Entities** tab.

Click the **Add entities** button to create the associated folders.

One entity will be created for each worksheet using the **Add entities** button.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-07-importsEntities.png)

In this case, a **Contact** entity was automatically created. The first line of the worksheet is used to determine the properties of the entity to add.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-08-entityOverview.png)

The corresponding mappings for the entity and its fields are also automatically created.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-09-entityMapping.png)

Click on the **Deploy** button.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-10-deployStore.png)

When your **Entity Store** has been deployed, you can export it as a new web API.

## 3. Deploy the Web API

Remaining on the **Entity Store**'s page, click on the **Actions** button (down-facing arrow) on the right of the **Deploy** button.

Select **Export custom API** and name it **Contact Entity Store API**.

The domain will be created automatically but may not be available anymore so make sure to adjust it.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-11-createAPI.png)

Click **Create**. You will be taken to the API's **Overview**.

The screenshot below shows some of the drop down menus opened to give you an idea of how it's organized.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-12-apiOverview.png)

Deploy the API by clicking the **Deploy** button.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-13-apiDeploySuccess.png)

The API should now be accessible online. To reach it, use the subdomain of apispark.net that you chose when you created the API.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-14-endpoint.png)

As you can see, the credentials required to invoke the API can be found in the **Overview** tab, by clicking on the relevant **Endpoint**.
You will need to copy the **Endpoint URI**, **Login** and **Password** information for the next step.

## 4. Invoke the Web API

Using a web API does not impose any particular programming language.
It can even be done from a web browser. However, to test your API we recommend the use of tools such as the Chrome extensions [<u>POSTMAN</u>](https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?utm_source=chrome-ntp-icon) and [<u>DHC</u>](http://sprintapi.com/dhcs.html) that provide a graphical user interface to perform HTTP calls. The following figure shows the call to the Contacts API with POSTMAN.

When using POSTMAN, click on the **Basic Auth** tab, fill in the **Username** and **Password** fields with the information copied from your APISpark **Endpoint**.
Fill in the **Endpoint URI** and add **/contacts/** at the end of it.

To retrieve the list of contacts in JSON, click the **Headers** button on the far right and input the **Accept** command in the **Header** field and write **application/json** in the **Value** field opposite.

Click the **Send** button.

The following figure shows the API call in POSTMAN.
  ![](/static/images/site/tutorials/tutorial-googlespreadsheet-15-postman.png)

Note that any POST requests made to the API will result in new data being created in your Google Spreadsheet. Likewise, any data manually inserted via the Google Spreadsheet is visible via the custom web API.

**Did you know?**

APISpark can also generate custom Client SDKs for different environments such as Java, Android, GWT and JavaScript (AJAX or Node.js). More environments will be supported in the future.

Congratulations on completing this tutorial! If you have questions or suggestions, feel free to contact the [<u>Help Desk</u>](http://support.apispark.com/).
